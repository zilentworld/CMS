<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC 
"-//Apache Software Foundation//DTD Struts Configuration 2.1//EN" 
"http://struts.apache.org/dtds/struts-2.1.dtd">
<struts>
    
<package name="default" namespace="/" extends="struts-default">

<!-- <include file="com/jiro/cms/struts-cms.xml"></include> -->
<!-- <include file="com/jiro/site/struts-site.xml"></include> -->
        
        <result-types>
            <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult" />
        </result-types>
                
	    <action name="/*" class="checkBlogUrl">
		    <param name="blogSiteUrl">{1}</param>
		    <result type="redirectAction">
		      <param name="actionName">checkBlogUrl</param>
		      <param name="blogSiteUrl">{1}</param> 
		    </result>
		</action>
    
	    <action name="showTemplate" class="newBlogSite"  method="showTemplate">
	        <result name="success">/WEB-INF/jsp/cmsPages/templatePicker.jsp</result>
	    </action>
	    
	    <action name="pickTemplate" class="newBlogSite">
	        <result name="error">/WEB-INF/jsp/cmsPages/templatePicker.jsp</result>
	        <result name="success">/WEB-INF/jsp/cmsPages/requestRegister.jsp</result>
	    </action>
	    
	    <action name="processRegister" class="registerCms">
	        <result name="error">/WEB-INF/jsp/cmsPages/requestRegister.jsp</result>
	        <result name="input">/WEB-INF/jsp/cmsPages/requestRegister.jsp</result>
	        <result name="success">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
	    </action>
	    
	    <action name="processLogin" class="loginAction">
	        <result name="error">/WEB-INF/jsp/cmsPages/requestRegister.jsp</result>
	        <result name="input">/WEB-INF/jsp/cmsPages/requestRegister.jsp</result>
	        <result name="success">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
	    </action>
	    
	    <action name="confirmUrl" class="userSiteAction">
	        <result name="input">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
	        <result name="error">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
	        <result name="success" type="redirectAction">
	        	<param name="actionName">checkBlogUrl</param>
	        	<param name="blogSiteUrl">${cmsUserSite.blogUrl}</param>
	        </result>
	    </action>
	    
	    <action name="checkBlogUrl" class="checkBlogUrl">
	    	<result name="success" type="redirectAction">
	    		<param name="actionName">postPreview</param>
	    		<param name="nextAction">${nextAction}</param>
	        	<param name="blogSiteUrl">${blogSiteUrl}</param>
			</result>
	    	<result name="error">/WEB-INF/jsp/cmsPages/index.jsp</result>
	    </action>        
	    
	    <action name="postPreview" class="blogPostAction">
	    	<result name="success" type="tiles">${nextAction}</result>
	    </action>
	    
	    <action name="postContent" class="postContentAction">
	    	<result name="success" type="tiles">${nextAction}</result>
	    </action>
	    
	    <action name="bannerImg" class="siteImgAction">
	    	<result name="success">/WEB-INF/jsp/sitePages/bannerImg.jsp</result>
	    </action>
	    
	    <action name="footerImg" class="siteImgAction">
	    	<result name="success">/WEB-INF/jsp/sitePages/footerImg.jsp</result>
	    </action>

</package>	    	    	    
    
</struts>
