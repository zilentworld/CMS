<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC 
"-//Apache Software Foundation//DTD Struts Configuration 2.1//EN" 
"http://struts.apache.org/dtds/struts-2.1.dtd">
<struts>

 	<constant name="struts.objectFactory" value="spring" />
 	<constant name="struts.enable.SlashesInActionNames" value="true"/>
	<constant name="struts.mapper.alwaysSelectFullNamespace" value="false"/>
	<package name="default" namespace="/" extends="struts-default">

		<!-- <include file="com/jiro/cms/struts-cms.xml"></include> -->
		<!-- <include file="com/jiro/site/struts-site.xml"></include> -->
  		
		<result-types>
			<result-type name="tiles"
				class="org.apache.struts2.views.tiles.TilesResult" />
		</result-types>
		
		<global-results>
			<result name="next" type="redirectAction">
				<param name="actionName">actionForward</param>
				<param name="nextAction">${nextAction}</param>
			</result>
			<!-- <result name="next" type="tiles">${nextAction}</result> -->
		</global-results>
		
		<action name="actionForward" class="actionForwarder">
			<result name="success" type="tiles">${nextAction}</result>
		</action>

		<action name="*/showLogin" class="siteLoginAction" method="showLogin">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="tiles">${nextAction}</result>
			<result name="input" type="tiles">${nextAction}</result>
		</action>

		<action name="*/doLogin" class="siteLoginAction">
			<param name="blogSiteUrl">{1}</param>
			<result name="input" type="tiles">${nextAction}</result>
			<result name="success" type="redirectAction">
				<param name="actionName">${blogSiteUrl}/postPreview</param>
				<param name="nextAction">${nextAction}</param>
			</result>
		</action>
		
		<action name="*/showRegister" class="siteRegisterAction" method="showRegister">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="tiles">${nextAction}</result>
			<result name="input" type="tiles">${nextAction}</result>
		</action>
		
		<action name="*/doRegister" class="siteRegisterAction">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="redirectAction">
				<param name="actionName">${blogSiteUrl}/postPreview</param>
				<param name="nextAction">${nextAction}</param>
			</result>
			<result name="input" type="tiles">${nextAction}</result>
		</action>
		
		<action name="*/doLogout" class="logoutAction">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="redirectAction">
				<param name="actionName">${blogSiteUrl}/postPreview</param>
				<param name="nextAction">${nextAction}</param>
			</result>
		</action>
		
		<action name="*/postContent" class="postContentAction">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="tiles">${nextAction}</result>
		</action>
		
		<action name="*/postPreview" class="blogPostAction">
			<param name="blogSiteUrl">{1}</param>
			<result name="success" type="tiles">${nextAction}</result>
		</action>

		<action name="/*" class="checkBlogUrl">
			<param name="blogSiteUrl">{1}</param>
			<result type="redirectAction">
				<param name="actionName">checkBlogUrl</param>
				<param name="blogSiteUrl">{1}</param>
			</result>
		</action>
		
		<action name="checkBlogUrl" class="checkBlogUrl">
			<result name="success" type="redirectAction">
				<param name="actionName">${blogSiteUrl}/postPreview</param>
				<param name="nextAction">${nextAction}</param>
			</result>
			<result name="error">/WEB-INF/jsp/cmsPages/index.jsp</result>
		</action>

		<action name="showTemplate" class="newBlogSite" method="showTemplate">
			<result name="success">/WEB-INF/jsp/cmsPages/templatePicker.jsp</result>
		</action>

		<action name="pickTemplate" class="newBlogSite">
			<result name="error">/WEB-INF/jsp/cmsPages/templatePicker.jsp</result>
			<result name="success">/WEB-INF/jsp/cmsPages/requestRegister.jsp
			</result>
		</action>

		<action name="processRegister" class="registerCms">
			<result name="error">/WEB-INF/jsp/cmsPages/requestRegister.jsp
			</result>
			<result name="input">/WEB-INF/jsp/cmsPages/requestRegister.jsp
			</result>
			<result name="success">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
		</action>

		<action name="processLogin" class="loginAction">
			<result name="error">/WEB-INF/jsp/cmsPages/requestRegister.jsp
			</result>
			<result name="input">/WEB-INF/jsp/cmsPages/requestRegister.jsp
			</result>
			<result name="success">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
		</action>

		<action name="confirmUrl" class="userSiteAction">
			<result name="input">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
			<result name="error">/WEB-INF/jsp/cmsPages/enterUrl.jsp</result>
			<result name="success" type="redirectAction">
				<param name="actionName">checkBlogUrl</param>
				<param name="blogSiteUrl">${cmsUserSite.blogUrl}</param>
			</result>
		</action>
		
		<action name="bannerImg" class="siteImgAction">
			<result name="success">/WEB-INF/jsp/sitePages/bannerImg.jsp</result>
		</action>

		<action name="footerImg" class="siteImgAction">
			<result name="success">/WEB-INF/jsp/sitePages/footerImg.jsp</result>
		</action>


	</package>

</struts>
